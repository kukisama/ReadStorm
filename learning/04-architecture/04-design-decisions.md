# 4.4 è®¾è®¡å†³ç­–ä¸å–èˆ

[â† ä¸Šä¸€ç« ï¼šé¢†åŸŸå»ºæ¨¡](03-domain-modeling.md) | [è¿”å›é¦–é¡µ](../README.md) | [ä¸‹ä¸€ç« ï¼šAvalonia UI å¼€å‘ â†’](../05-development/01-avalonia-ui-development.md)

---

## æ¦‚è¿°

æ¯ä¸ªè®¾è®¡å†³ç­–éƒ½æ˜¯ä¸€æ¬¡å–èˆã€‚æœ¬ç« è®°å½• ReadStorm å¼€å‘è¿‡ç¨‹ä¸­çš„å…³é”®å†³ç­–ã€èƒŒåçš„è€ƒé‡ä»¥åŠè¸©è¿‡çš„å‘ã€‚

---

## å†³ç­– 1ï¼šä¸ºä»€ä¹ˆç”¨ Avalonia è€Œé MAUI

### èƒŒæ™¯

ReadStorm éœ€è¦åŒæ—¶æ”¯æŒ Windowsã€Linuxã€macOS æ¡Œé¢ç«¯å’Œ Android ç§»åŠ¨ç«¯ã€‚

### é€‰é¡¹

- **MAUI**ï¼šå¾®è½¯å®˜æ–¹è·¨å¹³å° UI æ¡†æ¶
- **Avalonia**ï¼šç¤¾åŒºé©±åŠ¨çš„è·¨å¹³å° UI æ¡†æ¶

### å†³ç­–

é€‰æ‹© **Avalonia**ã€‚

### ç†ç”±

1. **Linux æ”¯æŒ**ï¼šMAUI ä¸æ”¯æŒ Linux æ¡Œé¢ï¼ŒReadStorm éœ€è¦
2. **UI ä¸€è‡´æ€§**ï¼šAvalonia çš„ Skia æ¸²æŸ“ä¿è¯å„å¹³å° UI å®Œå…¨ä¸€è‡´
3. **WPF ç»éªŒè¿ç§»**ï¼šå›¢é˜Ÿæœ‰ WPF èƒŒæ™¯ï¼ŒAvalonia çš„ AXAML å‡ ä¹å…¼å®¹
4. **ç¤¾åŒºæ´»è·ƒ**ï¼šAvalonia ç¤¾åŒºå“åº”å¿«ï¼Œç‰ˆæœ¬è¿­ä»£ç¨³å®š

### ä»£ä»·

- Avalonia åœ¨ Android ä¸Šçš„æ–‡æœ¬æ¸²æŸ“ä¾èµ– Skiaï¼Œä¸åŠ è½½ç³»ç»Ÿ emoji å­—ä½“
- éœ€è¦ç”¨ PathIcon + StreamGeometry æ›¿ä»£ Unicode å›¾æ ‡
- éƒ¨åˆ† Avalonia ç‰¹æœ‰çš„ API éœ€è¦å­¦ä¹ 

> è¯¦è§ [8.4 UI æ¸²æŸ“é—®é¢˜](../08-troubleshooting/04-ui-rendering-issues.md)

---

## å†³ç­– 2ï¼šFDD vs SCD å‘å¸ƒæ¨¡å¼

### èƒŒæ™¯

.NET åº”ç”¨æœ‰ä¸¤ç§å‘å¸ƒæ¨¡å¼ï¼š

- **FDD**ï¼ˆFramework-Dependent Deploymentï¼‰ï¼šä¾èµ–ç”¨æˆ·å·²å®‰è£…çš„ .NET Runtime
- **SCD**ï¼ˆSelf-Contained Deploymentï¼‰ï¼šæ‰“åŒ… Runtimeï¼Œä¸éœ€è¦ç”¨æˆ·å®‰è£…

### å†³ç­–

é€‰æ‹© **FDD**ã€‚

### ç†ç”±

1. **å®‰è£…åŒ…å°**ï¼šFDD çº¦ 15MBï¼ŒSCD çº¦ 80MB+
2. **æ›´æ–°çµæ´»**ï¼šRuntime å®‰å…¨è¡¥ä¸ä¸éœ€è¦é‡æ–°å‘å¸ƒåº”ç”¨
3. **è¿è¡Œå‰æ**ï¼šåœ¨ RELEASE_NOTES.md ä¸­æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·å®‰è£… .NET 10 Runtime

### ä»£ä»·

- ç”¨æˆ·éœ€è¦é¢å¤–å®‰è£… .NET 10 Runtime
- é¦–æ¬¡ä½¿ç”¨é—¨æ§›ç•¥é«˜

> è¯¦è§ [6.1 æ¡Œé¢ç«¯æ‰“åŒ…](../06-packaging/01-desktop-packaging.md)

---

## å†³ç­– 3ï¼šè§„åˆ™å¼•æ“ vs ç¡¬ç¼–ç çˆ¬è™«

### èƒŒæ™¯

ReadStorm éœ€è¦ä»å¤šä¸ªç½‘ç«™æœç´¢å’Œä¸‹è½½å›¾ä¹¦å†…å®¹ã€‚

### é€‰é¡¹

- **ç¡¬ç¼–ç **ï¼šæ¯ä¸ªç½‘ç«™å†™ä¸€ä¸ªä¸“é—¨çš„çˆ¬è™«ç±»
- **è§„åˆ™å¼•æ“**ï¼šé€šè¿‡ JSON è§„åˆ™æè¿°ç½‘ç«™ç»“æ„ï¼Œé€šç”¨å¼•æ“è§£ææ‰§è¡Œ

### å†³ç­–

é€‰æ‹© **è§„åˆ™å¼•æ“**ã€‚

### ç†ç”±

1. **å¯æ‰©å±•**ï¼šæ·»åŠ æ–°ä¹¦æºåªéœ€æ–°å¢ JSON è§„åˆ™æ–‡ä»¶ï¼Œä¸éœ€è¦å†™ä»£ç 
2. **å¯ç»´æŠ¤**ï¼šç½‘ç«™ç»“æ„å˜åŒ–æ—¶ä¿®æ”¹ JSONï¼Œä¸éœ€è¦é‡æ–°ç¼–è¯‘
3. **ç”¨æˆ·å¯é…**ï¼šç”¨æˆ·å¯ä»¥è‡ªå·±ç¼–å†™å’Œåˆ†äº«è§„åˆ™

### ä»£ä»·

- è§„åˆ™å¼•æ“çš„é€šç”¨æ€§æœ‰é™ï¼Œå¤æ‚ç½‘ç«™å¯èƒ½éœ€è¦ç‰¹æ®Šå¤„ç†
- JSON è§„åˆ™çš„è°ƒè¯•æ¯”ä»£ç è°ƒè¯•å›°éš¾
- éœ€è¦æä¾›è§„åˆ™ç¼–è¾‘å™¨è¾…åŠ©ç¼–å†™

> è¯¦è§ [5.5 è§„åˆ™å¼•æ“è®¾è®¡](../05-development/05-rules-engine.md)

---

## å†³ç­– 4ï¼šSQLite vs æ–‡ä»¶å­˜å‚¨

### èƒŒæ™¯

éœ€è¦æŒä¹…åŒ–å­˜å‚¨å›¾ä¹¦æ•°æ®ã€ç« èŠ‚å†…å®¹ã€é˜…è¯»çŠ¶æ€ã€‚

### å†³ç­–

é‡‡ç”¨ **SQLite + JSON æ–‡ä»¶æ··åˆ** æ–¹æ¡ˆã€‚

- **SQLite**ï¼šå­˜å‚¨å›¾ä¹¦å’Œç« èŠ‚æ•°æ®ï¼ˆç»“æ„åŒ–ã€æŸ¥è¯¢éœ€æ±‚é«˜ï¼‰
- **JSON æ–‡ä»¶**ï¼šå­˜å‚¨åº”ç”¨è®¾ç½®å’Œä¹¦æ¶çŠ¶æ€ï¼ˆç®€å•é…ç½®ï¼‰

### ç†ç”±

1. SQLite æ˜¯åµŒå…¥å¼æ•°æ®åº“ï¼Œä¸éœ€è¦ç‹¬ç«‹æœåŠ¡
2. æ”¯æŒ SQL æŸ¥è¯¢ï¼Œé€‚åˆç« èŠ‚ç®¡ç†
3. è·¨å¹³å°å…¼å®¹æ€§å¥½
4. JSON æ–‡ä»¶é€‚åˆç®€å•é…ç½®ï¼Œäººç±»å¯è¯»

---

## å†³ç­– 5ï¼šä¸‹è½½ä»»åŠ¡å¹¶å‘ç­–ç•¥

### èƒŒæ™¯

ç”¨æˆ·å¯èƒ½åŒæ—¶ä¸‹è½½å¤šæœ¬ä¹¦ï¼Œæ¯æœ¬ä¹¦æœ‰å‡ ç™¾ä¸ªç« èŠ‚ã€‚

### å†³ç­–

**åŒä¹¦æºä¸²è¡Œã€è·¨ä¹¦æºå¹¶è¡Œ**ã€‚

```
ä¹¦æºAçš„ä»»åŠ¡: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ï¼ˆä¸²è¡Œé˜Ÿåˆ—ï¼‰
ä¹¦æºBçš„ä»»åŠ¡: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ï¼ˆä¸²è¡Œé˜Ÿåˆ—ï¼‰
ä¹¦æºCçš„ä»»åŠ¡: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ï¼ˆä¸²è¡Œé˜Ÿåˆ—ï¼‰
            â†‘â†‘â†‘ ä¸‰ä¸ªä¹¦æºå¹¶è¡Œæ‰§è¡Œ â†‘â†‘â†‘
```

### ç†ç”±

1. **é¿å…è¢«å°**ï¼šåŒä¸€ä¹¦æºå¹¶å‘å¤ªå¤šä¼šè¢«æœåŠ¡å™¨å°ç¦
2. **èµ„æºå‹å¥½**ï¼šä¸²è¡Œå‡å°‘ç½‘ç»œè¿æ¥æ¶ˆè€—
3. **è·¨æºé«˜æ•ˆ**ï¼šä¸åŒä¹¦æºä¹‹é—´äº’ä¸å½±å“

> ğŸ’¡ ä¸‹è½½é˜Ÿåˆ—ç”± `SourceDownloadQueue` å®ç°ï¼Œå‚è§ [5.4 HTTP ä¸ HTML è§£æ](../05-development/04-http-and-html-parsing.md)

---

## å†³ç­– 6ï¼šåŒè½¨ Android ç­–ç•¥

### èƒŒæ™¯

Android é€‚é…æœ‰ä¸¤æ¡è·¯çº¿ã€‚

### å†³ç­–

åŒæ—¶ç»´æŠ¤ï¼š

1. **Avalonia Android**ï¼ˆ`src/ReadStorm.Android/`ï¼‰ï¼šä»£ç å¤ç”¨ç‡é«˜
2. **åŸç”Ÿ Kotlin**ï¼ˆ`pureopus/`ï¼‰ï¼šåŸç”Ÿä½“éªŒæœ€ä½³

### ç†ç”±

- Avalonia Android å…±äº« ~90% ä»£ç ï¼Œå¼€å‘æ•ˆç‡é«˜
- åŸç”Ÿ Kotlin ä½œä¸ºæ€§èƒ½åŸºå‡†å’Œä½“éªŒå¯¹ç…§
- éªŒè¯ä¸¤ç§æŠ€æœ¯è·¯çº¿çš„å¯è¡Œæ€§

### ä»£ä»·

- éœ€è¦ç»´æŠ¤ä¸¤å¥—ä»£ç 
- Kotlin ç‰ˆæœ¬åŠŸèƒ½å¯èƒ½æ»å

---

## è¸©è¿‡çš„å‘

| å‘ | ç°è±¡ | è§£å†³ | ç›¸å…³ç« èŠ‚ |
|----|------|------|----------|
| Android EmbedAssemblies | çœŸæœºå¯åŠ¨å´©æºƒ "No assemblies found" | å¿…é¡»è®¾ç½® `EmbedAssembliesIntoApk=true` | [8.2](../08-troubleshooting/02-android-specific-issues.md) |
| Emoji ä¸æ˜¾ç¤º | Android çœŸæœºå›¾æ ‡æŒ‰é’®ä¸å¯è§ | æ”¹ç”¨ PathIcon + StreamGeometry | [8.4](../08-troubleshooting/04-ui-rendering-issues.md) |
| Uri è§£æå·®å¼‚ | Linux ä¸Šç»å¯¹è·¯å¾„è¢«å½“ä½œ file:// URI | æ·»åŠ  `IsFile` è¿‡æ»¤ | [8.2](../08-troubleshooting/02-android-specific-issues.md) |
| Android æ–‡æ¡£è·¯å¾„ | `SpecialFolder.MyDocuments` è¿”å›ç©º | å›é€€é“¾ï¼šLocalAppData â†’ Personal â†’ AppData | [8.2](../08-troubleshooting/02-android-specific-issues.md) |
| å¤–é“¾æ‰“å¼€å¤±è´¥ | `Process.Start(url)` åœ¨ Android æŠ¥é”™ | ä½¿ç”¨ `Intent(ActionView)` + NewTask | [8.2](../08-troubleshooting/02-android-specific-issues.md) |

---

## å°ç»“

- æ¯ä¸ªè®¾è®¡å†³ç­–éƒ½æœ‰æ˜ç¡®çš„ç†ç”±å’Œå·²çŸ¥çš„ä»£ä»·
- å®é™…å¼€å‘ä¸­é‡åˆ°çš„å‘æ˜¯æœ€å®è´µçš„ç»éªŒ
- å¥½çš„æ¶æ„ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè€Œæ˜¯åœ¨ä¸æ–­è¿­ä»£ä¸­æ¼”è¿›çš„

---

[â† ä¸Šä¸€ç« ï¼šé¢†åŸŸå»ºæ¨¡](03-domain-modeling.md) | [è¿”å›é¦–é¡µ](../README.md) | [ä¸‹ä¸€ç« ï¼šAvalonia UI å¼€å‘ â†’](../05-development/01-avalonia-ui-development.md)
